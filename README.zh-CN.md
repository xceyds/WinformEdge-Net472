<p align="center">
    <img src="./artworks/WinFormedgeLogo.png" width="144" />
</p>
<h1 align="center">WinFormedge é¡¹ç›®</h1>
<p align="center">è¿™æ˜¯ä¸€ä¸ªåŸºäº Microsoft WebView2 çš„ .NET åº“ï¼Œå¯è½»æ¾ä½¿ç”¨ HTMLã€CSS å’Œ JavaScript æ„å»ºå¼ºå¤§çš„ WinForm åº”ç”¨ç¨‹åºã€‚</p>

## WinFormedge

![GitHub](https://img.shields.io/github/license/XuanchenLin/WinFormedge)
![Nuget](https://img.shields.io/nuget/v/WinFormedge)
![Nuget](https://img.shields.io/nuget/dt/WinFormedge)
[![Build](https://github.com/XuanchenLin/WinFormedge/actions/workflows/dotnet-desktop.yml/badge.svg)](https://github.com/XuanchenLin/WinFormedge/actions/workflows/dotnet-desktop.yml)

For `English`, please click [[HERE](README.md)] to switch.

## âœ¨ ç®€ä»‹

**WinFormedge** æ˜¯ä¸€ä¸ªåŸºäº **Microsoft WebView2** çš„å¼€æº .NET åº“ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ **HTMLã€CSS å’Œ JavaScript** åˆ›å»ºç°ä»£åŒ–ã€è§†è§‰å¸å¼•äººçš„ WinForms åº”ç”¨ç¨‹åºã€‚é€šè¿‡ WinFormedgeï¼Œæ‚¨å¯ä»¥æ— ç¼åœ°å°† Web æŠ€æœ¯é›†æˆåˆ° WinForm é¡¹ç›®ä¸­ï¼Œå®ç°ä¸°å¯Œä¸”äº¤äº’æ€§å¼ºçš„ç”¨æˆ·ç•Œé¢ã€‚

WinFormedge çš„çµæ„Ÿæ¥æºäºæˆ‘ç»´æŠ¤çš„å¦ä¸€ä¸ªé¡¹ç›®ï¼š**[WinFormium](https://github.com/xuanchenlin/NanUI)**ï¼ˆä¹Ÿç§°ä¸º **NanUI**ï¼‰ã€‚ä¸ WinFormedge ç±»ä¼¼ï¼ŒWinFormium å…è®¸å¼€å‘è€…ä½¿ç”¨ Web æŠ€æœ¯æ„å»º WinForms åº”ç”¨ç¨‹åºï¼Œä½†ä¸åŒäº WinFormedgeï¼Œå®ƒä¾èµ–äº **Chromium Embedded Framework (CEF)**ã€‚

![é¢„è§ˆ](./docs/preview1.png)

## ğŸ–¥ï¸ ç³»ç»Ÿè¦æ±‚

**å¼€å‘ç¯å¢ƒï¼š**

- Visual Studio 2022
- .NET 8.0 æˆ–æ›´é«˜ç‰ˆæœ¬

**éƒ¨ç½²ç¯å¢ƒï¼š**

- Windows 10 1903 æˆ–æ›´é«˜ç‰ˆæœ¬

è¿™æ˜¯ä¸€ä¸ª **ä»…æ”¯æŒ Windows** çš„åº“ï¼Œä¸å…¼å®¹å…¶ä»–æ“ä½œç³»ç»Ÿã€‚

æœ€ä½æ”¯æŒçš„æ“ä½œç³»ç»Ÿæ˜¯ Windows 10 ç‰ˆæœ¬ 1903ï¼ˆ2019 å¹´ 5 æœˆæ›´æ–°ï¼‰ã€‚æŸäº›åŠŸèƒ½ï¼ˆå¦‚ SystemBackdrop å’Œ SystemColorModeï¼‰ä»…åœ¨ Windows 11 ä¸Šå¯ç”¨ã€‚

## ğŸ§© æ›´æ–°æ—¥å¿—

WinFormedge é¡¹ç›®çš„æ›´æ–°æ—¥å¿—å¯åœ¨ [CHANGELOG.md](./CHANGELOG.md) æ–‡ä»¶ä¸­æŸ¥çœ‹ã€‚å…¶ä¸­åŒ…å«é¡¹ç›®çš„è¯¦ç»†å˜æ›´è®°å½•ã€é”™è¯¯ä¿®å¤å’Œæ–°åŠŸèƒ½ã€‚æ›´æ–°æ—¥å¿—ä¼šå®šæœŸæ›´æ–°ä»¥åæ˜ é¡¹ç›®çš„æœ€æ–°åŠ¨æ€ã€‚

## ğŸ”§ å®‰è£…

WinFormedge åº“å°šç°åœ¨å·²åœ¨ github è®¾ç½®äº†è‡ªåŠ¨åŒ– nuget å‘å¸ƒï¼Œæ‰€ä»¥æ‚¨èƒ½å¤Ÿä» nuget æ‰¾åˆ°æœ€æ–°ç‰ˆçš„ WinFormedge å‘è¡Œç‰ˆã€‚ä½¿ç”¨ NuGet åŒ…ç®¡ç†å™¨æˆ–è€…ä»»æ„ NuGet ç®¡ç†å·¥å…·æœç´¢å¹¶å®‰è£… `WinFormedge` å³å¯ã€‚

## ğŸª„ å¿«é€Ÿå…¥é—¨

é¦–å…ˆï¼Œæ‚¨éœ€è¦ä½¿ç”¨é»˜è®¤é¡¹ç›®æ¨¡æ¿åˆ›å»ºä¸€ä¸ª WinForm åº”ç”¨ç¨‹åºã€‚

### 1. ä½¿ç”¨ WinFormedge åº”ç”¨ç¨‹åºåˆå§‹åŒ–æµç¨‹æ›¿æ¢é»˜è®¤åˆå§‹åŒ–ä»£ç 

åœ¨ `program.cs` æ–‡ä»¶ä¸­ï¼Œæ‚¨åº”ä½¿ç”¨ `FormedgeApp` æ›¿ä»£ `Application` ç±»æ¥åˆå§‹åŒ– WinForm åº”ç”¨ç¨‹åºã€‚`FormedgeApp` ç±»æ˜¯ç”¨äºåˆ›å»º WinFormedge åº”ç”¨ç¨‹åºçš„æ„å»ºå™¨ï¼Œæä¾›äº†é…ç½®å’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚

```csharp
using WinFormedge;

namespace MinimalExampleApp;

internal static class Program
{
    [STAThread]
    static void Main()
    {
        ApplicationConfiguration.Initialize();

        var app = FormedgeApp.CreateBuilder()
            .UseDevTools()
            .UseWinFormedgeApp<MyFormedgeApp>().Build();

        app.Run();
    }
}
```

å½“ `FormedgeApp` ç±»åˆ›å»ºåï¼Œå®ƒå°†è‡ªåŠ¨åˆå§‹åŒ– WebView2 ç¯å¢ƒå¹¶è¿è¡Œæ¶ˆæ¯å¾ªç¯ã€‚

### 2. åˆ›å»º AppStartup ç±»

`AppStartup` ç±»æ˜¯ `WinFormedge` åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ï¼Œæä¾›äº†é…ç½®åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚æ‚¨å¯ä»¥é‡å†™ OnApplicationLaunched æ–¹æ³•ä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨å‰æ‰§è¡Œåˆå§‹åŒ–ä»»åŠ¡ã€‚

æ‚¨å¿…é¡»é‡å†™ `OnApplicationStartup` æ–¹æ³•æ¥åˆ›å»ºåº”ç”¨ç¨‹åºçš„ä¸»çª—å£ã€‚å½“è¯¥æ–¹æ³•è¿”å›ç”± `StartupOptions` ç±»ç”Ÿæˆçš„å€¼æ—¶ï¼Œ`FormedgeApp` ç±»å°†åˆ›å»ºåº”ç”¨ç¨‹åºä¸»çª—å£ï¼›è‹¥æ–¹æ³•è¿”å› `null`ï¼Œåˆ™åº”ç”¨ç¨‹åºå°†ç›´æ¥å…³é—­ã€‚

```C#
using WinFormedge;

namespace MinimalExampleApp;

internal class MyFormedgeApp : AppStartup
{
    protected override bool OnApplicationLaunched(string[] args)
    {
        return true;
    }
    protected override AppCreationAction? OnApplicationStartup(StartupOptions options)
    {
        return options.UseMainWindow(new MyWindow());
    }
}
```

æ‚¨å¯ä»¥åœ¨ `OnApplicationStartup` æ–¹æ³•ä¸­æ‰§è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚ç”¨æˆ·ç™»å½•ã€ç”¨æˆ·è®¾ç½®ç­‰ï¼Œä»¥å†³å®šä½¿ç”¨å“ªä¸ªçª—å£å¯åŠ¨åº”ç”¨ç¨‹åºã€‚æ­¤å¤–ï¼Œå¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œæ‚¨è¿˜å¯ä»¥é€šè¿‡è¿”å› `null` æ¥ç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚

### 3. åˆ›å»º MainWindow ç±»

`MyWindow` ç±»æ˜¯åº”ç”¨ç¨‹åºçš„ä¸»çª—å£ï¼Œç»§æ‰¿è‡ª `Formedge` ç±»ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ `Formedge` ç±»åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ WebView2 çš„çª—å£ã€‚

```C#
using WinFormedge;
using Microsoft.Web.WebView2.Core;

namespace MinimalExampleApp;
internal class MyWindow : Formedge
{
    public MyWindow()
    {
        Load += MyWindow_Load;
        DOMContentLoaded += MyWindow_DOMContentLoaded;

        Url = "https://cn.bing.com";
    }

    private void MyWindow_Load(object? sender, EventArgs e)
    {
        // çª—å£å’Œ WebView2 å·²å‡†å¤‡å°±ç»ª
    }

    private void MyWindow_DOMContentLoaded(object? sender, CoreWebView2DOMContentLoadedEventArgs e)
    {
        // DOM å†…å®¹å·²åŠ è½½å®Œæˆ
        ExecuteScriptAsync(""""
(()=>{
const headerEl = document.querySelector("#hdr");
headerEl.style.appRegion="drag";
})();
        """");
    }

    protected override WindowSettings ConfigureHostWindowSettings(HostWindowBuilder opts)
    {
        // é…ç½®ä¸»çª—å£è®¾ç½®
        var win = opts.UseDefaultWindow();

        win.ExtendsContentIntoTitleBar = true;
        win.MinimumSize = new Size(960, 480);
        win.Size = new Size(1280, 800);
        win.SystemBackdropType = SystemBackdropType.MicaAlt;
        win.AllowFullScreen = true;

        return win;
    }
}
```

ä¸Šè¿°ä»£ç åˆ›å»ºäº†ä¸€ä¸ª `Formedge` çª—å£ã€‚é€šè¿‡ä½¿ç”¨ `Url` å±æ€§ï¼Œæ‚¨å¯ä»¥è®¾ç½®çª—å£çš„åˆå§‹ URLã€‚

é»˜è®¤çª—å£å±æ€§å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½®ã€‚å¯¹äºçª—å£çš„ç‰¹æ®Šæ ·å¼å±æ€§ï¼Œæ‚¨éœ€è¦é‡å†™ `Formedge` ç±»çš„ `ConfigureHostWindowSettings` æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨å…¶ `HostWindowBuilder` å‚æ•°æ¥ç¡®å®šå°†é‡‡ç”¨å“ªç§çª—å£æ ·å¼ï¼Œä»¥åŠé…ç½®è¯¥çª—å£å…·æœ‰çš„ç‰¹æ®Šæ ·å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œé€šè¿‡ä½¿ç”¨ `HostWindowBuilder` å‚æ•°çš„ `UseDefaultWindow` æ–¹æ³•ï¼Œæ‚¨å¯ä»¥æŒ‡ç¤º Formedge åˆ›å»ºä¸€ä¸ªé»˜è®¤çª—å£ï¼Œå¹¶è®¾ç½®å…¶ `ExtendsContentIntoTitleBar` å±æ€§ä»¥å®ç°æ— è¾¹æ¡†æ•ˆæœã€‚

å½“çª—å£å’Œ WebView2 å‡†å¤‡å°±ç»ªæ—¶ï¼Œä¼šè§¦å‘ `Load` äº‹ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤äº‹ä»¶æ‰§è¡Œä»»ä½•éœ€è¦ WebView2 æ§ä»¶å‡†å¤‡å°±ç»ªçš„åˆå§‹åŒ–ä»»åŠ¡ã€‚

å½“ DOM å†…å®¹åŠ è½½å®Œæˆå¹¶å‡†å¤‡å°±ç»ªæ—¶ï¼Œä¼šè§¦å‘ `DOMContentLoaded` äº‹ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤äº‹ä»¶æ‰§è¡Œä»»ä½•éœ€è¦ DOM å†…å®¹åŠ è½½å®Œæˆçš„ä»»åŠ¡ã€‚å¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `ExecuteScriptAsync` æ–¹æ³•åœ¨ WebView2 æ§ä»¶ä¸­æ‰§è¡Œ JavaScript ä»£ç ã€‚ç¤ºä¾‹ä¸­çš„ JavaScript ä»£ç å°† header å…ƒç´ çš„ `appRegion` å±æ€§è®¾ç½®ä¸º `drag`ï¼Œè¿™å…è®¸ç”¨æˆ·é€šè¿‡ç‚¹å‡»å¹¶æ‹–åŠ¨è¿™äº›çŸ©å½¢ä¸Šçš„å…ƒç´ æ¥ç§»åŠ¨çª—å£ã€‚

### 4. è¿è¡Œåº”ç”¨ç¨‹åº

æ‚¨å¯ä»¥åœ¨ Visual Studio ä¸­æŒ‰ F5 è¿è¡Œåº”ç”¨ç¨‹åºã€‚åº”ç”¨ç¨‹åºå°†åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ WebView2 æ§ä»¶çš„çª—å£ï¼Œå¹¶æ˜¾ç¤ºå¿…åº”é¦–é¡µã€‚

![PREVIEW](./docs/preview.png)

## ğŸ“š æ–‡æ¡£

WinFormedge é¡¹ç›®çš„æ–‡æ¡£ç›®å‰å°šæœªæä¾›ã€‚ä¸è¿‡æ‚¨å¯ä»¥åœ¨ `src` å’Œ `examples` æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æºä»£ç å’Œç¤ºä¾‹ã€‚å½“å‰æºä»£ç å·²åŒ…å«å®Œå–„çš„æ³¨é‡Šè¯´æ˜ï¼Œå¹¶æä¾›äº†ä½¿ç”¨ WinFormedge åº“çš„ç¤ºä¾‹ã€‚

## ğŸ› ï¸ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§è´¡çŒ®ï¼å¦‚æœæ‚¨æœ‰ä»»ä½•æƒ³æ³•ã€å»ºè®®æˆ–é”™è¯¯æŠ¥å‘Šï¼Œè¯·éšæ—¶æäº¤ issue æˆ– pull requestã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦æƒ…è¯·å‚é˜… [LICENSE](./LICENSE) æ–‡ä»¶ã€‚

## ğŸ§­ è‡´è°¢

- [Microsoft WebView2](https://developer.microsoft.com/en-us/microsoft-edge/webview2/)
- [Chromium Embedded Framework](https://bitbucket.org/chromiumembedded/cef)
- [NanUI](https://github.com/XuanchenLin/NanUI)
- [WinFormium](https://github.com/XuanchenLin/WinFormium)
